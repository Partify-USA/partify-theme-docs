"use strict";(globalThis.webpackChunkpartify_usa=globalThis.webpackChunkpartify_usa||[]).push([[275],{735(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"product-page/vin-decoder","title":"VIN Decoder Input Box","description":"Overview","source":"@site/docs/product-page/vin-decoder.md","sourceDirName":"product-page","slug":"/product-page/vin-decoder","permalink":"/docs/product-page/vin-decoder","draft":false,"unlisted":false,"editUrl":"https://github.com/partify/partify-theme-docs/tree/main/docs/product-page/vin-decoder.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Product Page","permalink":"/docs/category/product-page"}}');var s=i(4848),r=i(8453);const l={sidebar_position:1},a="VIN Decoder Input Box",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"High-Level Design",id:"high-level-design",level:3},{value:"Why Two Instances?",id:"why-two-instances",level:3},{value:"Instance System",id:"instance-system",level:2},{value:"Instance Parameter Flow",id:"instance-parameter-flow",level:3},{value:"Liquid Template Processing",id:"liquid-template-processing",level:3},{value:"Two Instance Scenarios",id:"two-instance-scenarios",level:2},{value:"Scenario 1: &quot;After&quot; Instance",id:"scenario-1-after-instance",level:3},{value:"Scenario 2: &quot;ByVin&quot; Instance",id:"scenario-2-byvin-instance",level:3},{value:"Component Structure",id:"component-structure",level:2},{value:"HTML Structure (Per Instance)",id:"html-structure-per-instance",level:3},{value:"CSS Classes",id:"css-classes",level:3},{value:"Instance Initialization Flow",id:"instance-initialization-flow",level:2},{value:"Step 1: Template Render",id:"step-1-template-render",level:3},{value:"Step 2: Instance Variable Capture (IIFE)",id:"step-2-instance-variable-capture-iife",level:3},{value:"Step 3: DOM Ready Event Listener",id:"step-3-dom-ready-event-listener",level:3},{value:"Step 4: Submit Button Listener",id:"step-4-submit-button-listener",level:3},{value:"Input Event Flow",id:"input-event-flow",level:2},{value:"Complete Input Processing Pipeline",id:"complete-input-processing-pipeline",level:3},{value:"Detailed Breakdown",id:"detailed-breakdown",level:3},{value:"1. Initial Processing",id:"1-initial-processing",level:4},{value:"2. Retry Check (handleVinChange)",id:"2-retry-check-handlevinchange",level:4},{value:"3. Character Filtering",id:"3-character-filtering",level:4},{value:"4. Fitment Validation",id:"4-fitment-validation",level:4},{value:"5. Inclusion Character Validation",id:"5-inclusion-character-validation",level:4},{value:"6. Error Message Display Logic",id:"6-error-message-display-logic",level:4},{value:"7. Submit Button State",id:"7-submit-button-state",level:4},{value:"8. Add to Cart Button Logic",id:"8-add-to-cart-button-logic",level:4},{value:"9. Progress Header Update",id:"9-progress-header-update",level:4},{value:"Submit Event Flow",id:"submit-event-flow",level:2},{value:"Complete Submission Pipeline",id:"complete-submission-pipeline",level:3},{value:"Detailed Breakdown",id:"detailed-breakdown-1",level:3},{value:"1. Initial Validation",id:"1-initial-validation",level:4},{value:"2. Loading State",id:"2-loading-state",level:4},{value:"3. VIN Decode API Call",id:"3-vin-decode-api-call",level:4},{value:"4. Success Path",id:"4-success-path",level:4},{value:"5. Failure Path",id:"5-failure-path",level:4},{value:"6. Max Attempts Handling",id:"6-max-attempts-handling",level:4},{value:"7. Cleanup",id:"7-cleanup",level:4},{value:"Key Functions Reference",id:"key-functions-reference",level:2},{value:"handleVinChange()",id:"handlevinchange",level:3},{value:"handleVinDecode()",id:"handlevindecode",level:3},{value:"handleInsertLocalStoragePaintOption()",id:"handleinsertlocalstoragepaintoption",level:3},{value:"hideVinInputIfVinExist()",id:"hidevininputifvinexist",level:3},{value:"hidePaintCodeWrapper()",id:"hidepaintcodewrapper",level:3},{value:"checkVinFitment()",id:"checkvinfitment",level:3},{value:"State Management",id:"state-management",level:2},{value:"Global Variables (Shared Across Instances)",id:"global-variables-shared-across-instances",level:3},{value:"Instance-Specific Variables (IIFE Scoped)",id:"instance-specific-variables-iife-scoped",level:3},{value:"UI Visibility Rules",id:"ui-visibility-rules",level:2},{value:"When &quot;After&quot; Instance is Shown",id:"when-after-instance-is-shown",level:3},{value:"When &quot;ByVin&quot; Instance is Shown",id:"when-byvin-instance-is-shown",level:3},{value:"When Both are Hidden",id:"when-both-are-hidden",level:3},{value:"Error Message Hierarchy",id:"error-message-hierarchy",level:2},{value:"Validation Error (Real-time)",id:"validation-error-real-time",level:3},{value:"Failed Attempt (After Submit)",id:"failed-attempt-after-submit",level:3},{value:"Remaining Attempts",id:"remaining-attempts",level:3},{value:"Exhausted Attempts (3 Failures)",id:"exhausted-attempts-3-failures",level:3},{value:"Success Message",id:"success-message",level:3},{value:"Complete User Journey Examples",id:"complete-user-journey-examples",level:2},{value:"Journey 1: Success on First Try (&quot;ByVin&quot; Instance)",id:"journey-1-success-on-first-try-byvin-instance",level:3},{value:"Journey 2: Failure After 3 Attempts (&quot;ByVin&quot; Instance)",id:"journey-2-failure-after-3-attempts-byvin-instance",level:3},{value:"Journey 3: Optional VIN After Paint Selection (&quot;After&quot; Instance)",id:"journey-3-optional-vin-after-paint-selection-after-instance",level:3},{value:"Technical Notes",id:"technical-notes",level:2},{value:"Why IIFE (Immediately Invoked Function Expression)?",id:"why-iife-immediately-invoked-function-expression",level:3},{value:"Instance Isolation Guarantees",id:"instance-isolation-guarantees",level:3},{value:"Common Pitfalls",id:"common-pitfalls",level:3},{value:"Debugging Guide",id:"debugging-guide",level:2},{value:"Check Which Instance is Active",id:"check-which-instance-is-active",level:3},{value:"Verify Instance Event Listeners",id:"verify-instance-event-listeners",level:3},{value:"Track VIN Decode State",id:"track-vin-decode-state",level:3},{value:"Monitor API Calls",id:"monitor-api-calls",level:3},{value:"Summary Comparison Table",id:"summary-comparison-table",level:2},{value:"Conclusion",id:"conclusion",level:2}];function o(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"vin-decoder-input-box",children:"VIN Decoder Input Box"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:["The VIN decoder input box system handles two distinct user flows for entering Vehicle Identification Numbers (VINs) on product pages. The system uses a single reusable snippet (",(0,s.jsx)(n.code,{children:"vin-decoder-input-box.liquid"}),") that creates independent instances with unique IDs to support multiple VIN entry points on the same page."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#architecture-overview",children:"Architecture Overview"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#instance-system",children:"Instance System"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#two-instance-scenarios",children:"Two Instance Scenarios"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#component-structure",children:"Component Structure"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#instance-initialization-flow",children:"Instance Initialization Flow"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#input-event-flow",children:"Input Event Flow"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#submit-event-flow",children:"Submit Event Flow"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#key-functions-reference",children:"Key Functions Reference"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#state-management",children:"State Management"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#ui-visibility-rules",children:"UI Visibility Rules"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,s.jsx)(n.h3,{id:"high-level-design",children:"High-Level Design"}),"\n",(0,s.jsxs)(n.p,{children:["The VIN decoder input box uses an ",(0,s.jsx)(n.strong,{children:"instance-based architecture"})," where:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A single Liquid snippet template (",(0,s.jsx)(n.code,{children:"vin-decoder-input-box.liquid"}),") is rendered multiple times"]}),"\n",(0,s.jsxs)(n.li,{children:["Each render receives a unique ",(0,s.jsx)(n.code,{children:"instance"})," parameter (",(0,s.jsx)(n.code,{children:"'after'"})," or ",(0,s.jsx)(n.code,{children:"'byvin'"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"The instance parameter creates namespace isolation via unique element IDs"}),"\n",(0,s.jsx)(n.li,{children:"JavaScript uses an IIFE (Immediately Invoked Function Expression) to encapsulate instance-specific logic"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"why-two-instances",children:"Why Two Instances?"}),"\n",(0,s.jsx)(n.p,{children:"The product page provides two different entry points for users to enter their VIN:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:'"After" instance'})," - Shown AFTER user selects a paint code option (instance: ",(0,s.jsx)(n.code,{children:"'after'"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:'"ByVin" instance'})," - Shown when user chooses to find paint code BY VIN (instance: ",(0,s.jsx)(n.code,{children:"'byvin'"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Both instances:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Use the same validation logic"}),"\n",(0,s.jsx)(n.li,{children:"Call the same API endpoints"}),"\n",(0,s.jsx)(n.li,{children:"Share the same global state variables"}),"\n",(0,s.jsx)(n.li,{children:"Display identical UI components with different IDs"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"instance-system",children:"Instance System"}),"\n",(0,s.jsx)(n.h3,{id:"instance-parameter-flow",children:"Instance Parameter Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"product-page-paint-options.liquid\n    \u2502\n    \u251c\u2500> {% render 'vin-decoder-input-box', instance: 'after' %}\n    \u2502   Creates:\n    \u2502   - vin-decoder-textbox-for-verification-wrapper-after\n    \u2502   - vin-decoder-textbox-for-verification-after\n    \u2502   - vin-validation-error-after\n    \u2502   - button[data-instance=\"after\"]\n    \u2502\n    \u2514\u2500> {% render 'vin-decoder-input-box', instance: 'byvin' %}\n        Creates:\n        - vin-decoder-textbox-for-verification-wrapper-byvin\n        - vin-decoder-textbox-for-verification-byvin\n        - vin-validation-error-byvin\n        - button[data-instance=\"byvin\"]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"liquid-template-processing",children:"Liquid Template Processing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-liquid",children:"{% assign instance_suffix = instance | default: 'default' %}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Receives ",(0,s.jsx)(n.code,{children:"instance"})," parameter from parent template"]}),"\n",(0,s.jsxs)(n.li,{children:["Defaults to ",(0,s.jsx)(n.code,{children:"'default'"})," if no parameter provided"]}),"\n",(0,s.jsx)(n.li,{children:"Used throughout template to generate unique IDs"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example ID Generation:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-liquid",children:'<input id="vin-decoder-textbox-for-verification-{{ instance_suffix }}" ... >\n'})}),"\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"instance: 'after'"})," \u2192 ",(0,s.jsx)(n.code,{children:'id="vin-decoder-textbox-for-verification-after"'}),"\nFor ",(0,s.jsx)(n.code,{children:"instance: 'byvin'"})," \u2192 ",(0,s.jsx)(n.code,{children:'id="vin-decoder-textbox-for-verification-byvin"'})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"two-instance-scenarios",children:"Two Instance Scenarios"}),"\n",(0,s.jsx)(n.h3,{id:"scenario-1-after-instance",children:'Scenario 1: "After" Instance'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location:"})," ",(0,s.jsx)(n.code,{children:"#vin-decoder-after-selection"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"When Shown:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"User has already selected a paint code option"}),"\n",(0,s.jsx)(n.li,{children:"System prompts for VIN to validate/enhance the order"}),"\n",(0,s.jsx)(n.li,{children:"Optional in most cases (can be required based on product settings)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parent Container:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<div id=\"vin-decoder-after-selection\" style=\"display: none\">\n\t{% render 'vin-decoder-input-box', instance: 'after' %}\n</div>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use Case:"}),'\nUser selects "Paint Code XYZ" from dropdown \u2192 System shows "after" VIN input \u2192 User can optionally provide VIN for order tracking/verification']}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Behaviors:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Often optional (unless ",(0,s.jsx)(n.code,{children:".required"})," class added)"]}),"\n",(0,s.jsx)(n.li,{children:"Validates VIN matches selected paint code"}),"\n",(0,s.jsx)(n.li,{children:"May show mismatch warnings if VIN doesn't match"}),"\n",(0,s.jsx)(n.li,{children:"Enhances order data with vehicle details"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"scenario-2-byvin-instance",children:'Scenario 2: "ByVin" Instance'}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location:"})," ",(0,s.jsx)(n.code,{children:"#paintcode-app-container > #vin-decoder-option"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"When Shown:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'User selects "Find my paint code using VIN" radio option'}),"\n",(0,s.jsx)(n.li,{children:"VIN is REQUIRED to determine paint code"}),"\n",(0,s.jsx)(n.li,{children:"Primary method for VIN-based paint code lookup"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parent Container:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div id="paintcode-app-container">\n\t<div class="two-tone-message">...</div>\n\t<div id="vin-decoder-option" style="display: none">\n\t\t{% render \'vin-decoder-input-box\', instance: \'byvin\' %}\n\t</div>\n</div>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use Case:"}),'\nUser doesn\'t know paint code \u2192 Selects "Use VIN" option \u2192 System shows "byvin" VIN input \u2192 User enters VIN \u2192 System decodes VIN and auto-selects paint code']}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Behaviors:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Required input (user cannot proceed without valid VIN)"}),"\n",(0,s.jsx)(n.li,{children:"Performs VIN decode API call"}),"\n",(0,s.jsx)(n.li,{children:"Populates paint code dropdown based on response"}),"\n",(0,s.jsx)(n.li,{children:"Shows two-tone paint warning message"}),"\n",(0,s.jsx)(n.li,{children:"Handles decode failures and retries (max 3 attempts)"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"component-structure",children:"Component Structure"}),"\n",(0,s.jsx)(n.h3,{id:"html-structure-per-instance",children:"HTML Structure (Per Instance)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div\n\tid="vin-decoder-textbox-for-verification-wrapper-{instance}"\n\tclass="vin-decoder-wrapper show"\n>\n\t\x3c!-- Optional label section (shown for \'after\' instance) --\x3e\n\t<div\n\t\tid="vin-after-paint-code-selection-{instance}"\n\t\tclass="vin-after-paint-code-selection show"\n\t>\n\t\t<label class="vin-after-paint-code-guarantee">\n\t\t\tPlease provide VIN (optional)\n\t\t</label>\n\t\t<span class="vin-after-paint-code-optional"></span>\n\t</div>\n\n\t\x3c!-- Stored VIN message (if VIN exists in localStorage) --\x3e\n\t<div class="stored-vin-message" style="display: none;"></div>\n\n\t\x3c!-- Input and submit section --\x3e\n\t<div class="vin-input-label-and-textbox" style="display: block">\n\t\t<label\n\t\t\tid="vin-decoder-textbox-label-{instance}"\n\t\t\tclass="vin-decoder-textbox-label"\n\t\t>\n\t\t\tVIN\n\t\t</label>\n\t\t<input\n\t\t\ttype="text"\n\t\t\tid="vin-decoder-textbox-for-verification-{instance}"\n\t\t\tplaceholder="e.g. 18UYA31581L000000"\n\t\t\tclass="vin-decoder-textbox"\n\t\t\tmaxlength="17"\n\t\t\tname="properties[VIN]"\n\t\t/>\n\t\t<button\n\t\t\ttype="button"\n\t\t\tclass="vin-decoder-submit-btn"\n\t\t\tdata-instance="{instance}"\n\t\t\tdisabled\n\t\t>\n\t\t\tSubmit\n\t\t</button>\n\t</div>\n\n\t\x3c!-- Error/success messages container --\x3e\n\t<div class="vin-error-message-container" style="display:none">\n\t\t<div\n\t\t\tclass="vin-validation-error"\n\t\t\tid="vin-validation-error-{instance}"\n\t\t></div>\n\t\t<div class="vin-decoder-failed-attempt" style="display: none;">...</div>\n\t\t<div class="vin-decoder-remaining-attempts" style="display: none;">...</div>\n\t\t<div class="vin-decoder-fetching-vin-data" style="display: none;">...</div>\n\t\t<div class="vin-decoder-submission-failed-message" style="display: none;">\n\t\t\t...\n\t\t</div>\n\t\t<div class="vin-decoder-submission-success-message" style="display: none;">\n\t\t\t...\n\t\t</div>\n\t</div>\n</div>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"css-classes",children:"CSS Classes"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Wrapper States:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".vin-decoder-wrapper"})," - Base wrapper (hidden by default)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".vin-decoder-wrapper.show"})," - Visible state (max-height: fit-content, opacity: 1)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Input States:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".vin-decoder-textbox"})," - Normal enabled state"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".vin-decoder-textbox:disabled"})," - Disabled state (grayed out)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Submit Button States:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".vin-decoder-submit-btn"})," - Enabled blue button"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".vin-decoder-submit-btn:disabled"})," - Disabled gray button"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".vin-decoder-submit-btn--loading"})," - Loading state with spinner"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"instance-initialization-flow",children:"Instance Initialization Flow"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-template-render",children:"Step 1: Template Render"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-liquid",children:"{% render 'vin-decoder-input-box', instance: 'after' %}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-instance-variable-capture-iife",children:"Step 2: Instance Variable Capture (IIFE)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"<script>\n(function() {\n  const instance = '{{ instance_suffix }}';  // Captures 'after' or 'byvin'\n  const vinInputByInstance = document.getElementById(`vin-decoder-textbox-for-verification-${instance}`);\n  const wrapper = document.getElementById(`vin-decoder-textbox-for-verification-wrapper-${instance}`);\n  const vinErrorMsgContainer = wrapper.querySelector(\".vin-error-message-container\");\n\n  // ... rest of instance-specific code\n})()\n<\/script>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Key Point:"})," The IIFE creates a closure that captures the ",(0,s.jsx)(n.code,{children:"instance"})," value at render time, ensuring each instance has its own isolated scope."]}),"\n",(0,s.jsx)(n.h3,{id:"step-3-dom-ready-event-listener",children:"Step 3: DOM Ready Event Listener"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'document.addEventListener("DOMContentLoaded", async function () {\n\tconst garageSearchTerms = getSearchTerms();\n\n\t// Attach input event listener specific to this instance\n\tvinInputByInstance.addEventListener("input", async function (event) {\n\t\t// ... validation logic\n\t});\n});\n'})}),"\n",(0,s.jsx)(n.h3,{id:"step-4-submit-button-listener",children:"Step 4: Submit Button Listener"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'const vinSubmitBtn = document.querySelector(`[data-instance="${instance}"]`);\n\nif (vinSubmitBtn) {\n\tvinSubmitBtn.addEventListener("click", async function () {\n\t\t// ... submission logic\n\t});\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Selector Strategy:"})," Uses ",(0,s.jsx)(n.code,{children:"data-instance"})," attribute to find the correct submit button for this instance."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"input-event-flow",children:"Input Event Flow"}),"\n",(0,s.jsx)(n.h3,{id:"complete-input-processing-pipeline",children:"Complete Input Processing Pipeline"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"User types in VIN input\n    \u2193\nInput event fires\n    \u2193\n1. Capture original value\n    \u2193\n2. Convert to uppercase\n    \u2193\n3. Call handleVinChange(event, 3, errorMsg)\n    \u2193\n4. Filter invalid characters\n    \u2193\n5. Check fitment restrictions (if applicable)\n    \u2193\n6. Validate character inclusion rules\n    \u2193\n7. Show/hide error messages\n    \u2193\n8. Enable/disable submit button\n    \u2193\n9. Update Add to Cart button state\n    \u2193\n10. Update progress header colors\n"})}),"\n",(0,s.jsx)(n.h3,{id:"detailed-breakdown",children:"Detailed Breakdown"}),"\n",(0,s.jsx)(n.h4,{id:"1-initial-processing",children:"1. Initial Processing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"vinInputByInstance.addEventListener('input', async function (event) {\n  const originalValue = event.target.value;\n  let vinInput = originalValue.toUpperCase();\n  let shouldShowErrorMsg = false;\n  let errorMsg = \"\";\n"})}),"\n",(0,s.jsx)(n.h4,{id:"2-retry-check-handlevinchange",children:"2. Retry Check (handleVinChange)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const isRetryed = handleVinChange(event, 3, '{{ 'garage.enter_valid_characters' | t }}');\nconst validationError = document.getElementById(`vin-validation-error-${instance}`);\n\nif (isRetryed) {\n  return;  // Stop processing if user is in retry state\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Prevents users from entering more characters if they've exceeded retry limits."]}),"\n",(0,s.jsx)(n.h4,{id:"3-character-filtering",children:"3. Character Filtering"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'const filteredValue = vinInput.replace(\n\t/[IOQ\\s:;()!@#$%^?\'"&*\\-_=+.`~<>{}\\[\\]|,\\/\\\\]/gi,\n\t""\n);\nconst hadInvalidChars = vinInput !== filteredValue;\nevent.target.value = filteredValue;\nvinInput = filteredValue;\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Filtered Characters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Letters: I, O, Q (not valid in VINs)"}),"\n",(0,s.jsx)(n.li,{children:"Whitespace"}),"\n",(0,s.jsxs)(n.li,{children:["Special characters: ",(0,s.jsx)(n.code,{children:":;()!@#$%^?'\"&*-_=+.\\"}),"~<>","[]|,/`"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"4-fitment-validation",children:"4. Fitment Validation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const title = '{{ 'vin_decoder_product_page.vin_question' | t }}';\nconst fitmentTypeSelect = Array.from(document.querySelectorAll('.option-title-fitment'))\n  .find(element => element.textContent === title);\n\nif (fitmentTypeSelect) {\n  const { isCharPresent, inclusionChars, inclusionCountry, exclusionChars, exclusionCountry, groupIndex }\n    = checkVinFitment(vinInput);\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"}),' Some products have country-specific fitment requirements (e.g., "VIN must start with 1, 4, or 5 for US vehicles").']}),"\n",(0,s.jsx)(n.h4,{id:"5-inclusion-character-validation",children:"5. Inclusion Character Validation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"if (inclusionChars) {\n  if (vinInput.length > 0 && !isCharPresent) {\n    shouldShowErrorMsg = true;\n    errorMsg = '{{ 'vin_decoder_product_page.err_msg' | t }}' + ' ' + `\"${inclusionChars}\"`;\n  }\n\n  // Check for copy-paste of full 17-character VIN\n  if (vinInput.length === 17 && !isCharPresent) {\n    toggleCollectionRedirectModal(event, vinInput, groupIndex, inclusionCountry,\n                                  exclusionChars, exclusionCountry, true,\n                                  compatibilityQuestionModal, '{{ currentLocale }}');\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Modal Trigger:"})," If user pastes full VIN that doesn't match inclusion requirements, show compatibility question modal."]}),"\n",(0,s.jsx)(n.h4,{id:"6-error-message-display-logic",children:"6. Error Message Display Logic"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Hide error if VIN is complete (17 characters) or empty\nif (vinInput.length === 17 || vinInput.length === 0) {\n\tshouldShowErrorMsg = false;\n}\n\nif (shouldShowErrorMsg) {\n\tif (vinErrorMsgContainer) vinErrorMsgContainer.style.display = "block";\n\n\tconst failedAttemptsElement = wrapper.querySelector(\n\t\t".vin-decoder-failed-attempt"\n\t);\n\tconst remainingAttemptsElement = wrapper.querySelector(\n\t\t".vin-decoder-remaining-attempts"\n\t);\n\tif (failedAttemptsElement || remainingAttemptsElement) {\n\t\tfailedAttemptsElement.style.display = "none";\n\t\tremainingAttemptsElement.style.display = "none";\n\t}\n\n\tvalidationError.textContent = errorMsg;\n\tvalidationError.style.display = "block";\n} else {\n\tvalidationError.style.display = "none";\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"7-submit-button-state",children:"7. Submit Button State"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"if (vinSubmitBtn) {\n\tvinSubmitBtn.disabled = vinInput.length !== 17;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Rule:"})," Submit button only enabled when VIN is exactly 17 characters."]}),"\n",(0,s.jsx)(n.h4,{id:"8-add-to-cart-button-logic",children:"8. Add to Cart Button Logic"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'if (vinInput.length === 0) {\n\tdisableAddToCartButton();\n} else if (vinInput.length < 17) {\n\tdisableAddToCartButton();\n}\n\n// Special case: Paint code selected\nconst isSelectPaintCodeSelected = document.getElementById(\n\t"checkbox-select-paint-option"\n)?.checked;\n\nif (isSelectPaintCodeSelected) {\n\tif (vinInput.length === 17) {\n\t\tdisableAddToCartButton(); // Disable until VIN submitted\n\t}\n\n\tif (!window.isPaintUnavailable) {\n\t\tif (vinInput.length === 0 && !selectedVariantUnavailable) {\n\t\t\tenableAddToCartButton(); // Allow checkout without VIN if paint code selected\n\t\t} else if (vinInput.length === 17) {\n\t\t\tenableAddToCartButton(); // Enable after valid VIN entered\n\t\t}\n\t} else {\n\t\tif (vinInput.length === 17) {\n\t\t\tenableAddToCartButton();\n\t\t}\n\t}\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Complex Logic:"})," Add to Cart availability depends on:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"VIN length"}),"\n",(0,s.jsx)(n.li,{children:"Paint code selection state"}),"\n",(0,s.jsx)(n.li,{children:"Paint availability"}),"\n",(0,s.jsx)(n.li,{children:"Variant availability"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"9-progress-header-update",children:"9. Progress Header Update"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"updateProgressHeaderColors();\n"})}),"\n",(0,s.jsx)(n.p,{children:"Updates visual progress indicator at top of page."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"submit-event-flow",children:"Submit Event Flow"}),"\n",(0,s.jsx)(n.h3,{id:"complete-submission-pipeline",children:"Complete Submission Pipeline"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"User clicks Submit button\n    \u2193\n1. Check button state (disabled/loading)\n    \u2193\n2. Validate VIN length === 17\n    \u2193\n3. Show loading spinner\n    \u2193\n4. Call handleVinDecode() API\n    \u2193\n5a. SUCCESS PATH               5b. FAILURE PATH\n    \u2193                              \u2193\nAuto-select paint code         Push to attemptedDecodedVins[]\n    \u2193                              \u2193\nCheck stored code              Disable submit button\n    \u2193                              \u2193\nHide VIN input                 Check attempt count\n    \u2193                              \u2193\nHide paint code wrapper        If >= 3: Force manual select\n    \u2193                              \u2193\nEnable Add to Cart             Disable Add to Cart\n    \u2193\n6. Remove loading spinner\n    \u2193\n7. Update progress header\n"})}),"\n",(0,s.jsx)(n.h3,{id:"detailed-breakdown-1",children:"Detailed Breakdown"}),"\n",(0,s.jsx)(n.h4,{id:"1-initial-validation",children:"1. Initial Validation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"vinSubmitBtn.addEventListener('click', async function() {\n  // Prevent double-click or disabled click\n  if (vinSubmitBtn.disabled || vinSubmitBtn.classList.contains('vin-decoder-submit-btn--loading')) {\n    return;\n  }\n\n  // Get instance-specific input element\n  const vinInputElem = document.getElementById(`vin-decoder-textbox-for-verification-${instance}`);\n  const vinInput = vinInputElem.value.trim().toUpperCase();\n\n  // Validate length\n  if (vinInput.length !== 17) {\n    alert('VIN must be exactly 17 characters.');\n    return;\n  }\n"})}),"\n",(0,s.jsx)(n.h4,{id:"2-loading-state",children:"2. Loading State"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'vinSubmitBtn._originalText = vinSubmitBtn.textContent;\nvinSubmitBtn.textContent = "";\nvinSubmitBtn.classList.add("vin-decoder-submit-btn--loading");\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Visual Effect:"})," Button text disappears, spinning loader appears via CSS ",(0,s.jsx)(n.code,{children:"::after"})," pseudo-element."]}),"\n",(0,s.jsx)(n.h4,{id:"3-vin-decode-api-call",children:"3. VIN Decode API Call"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'let isBumperdotcom = "{{ is_bumperdotcom_make_found }}" === "true";\n\nconst isVinValidWithPaintCode = await handleVinDecode(\n\tvinInput, // VIN string\n\t"", // License plate (empty for VIN decode)\n\t"", // Additional param\n\t3, // Max attempts\n\tisBumperdotcom, // API selection flag\n\tfailed3timesmsg, // Error messages...\n\tnoResults,\n\tsearchBtn,\n\ttailoredSuccessMessage,\n\tfailedAttempt,\n\tremainingAttempts,\n\tvinDecoderFirstMsg,\n\tvinDecoderEndMsg,\n\tforceSelectMsgStart,\n\tforceSelectMsgEnd\n);\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"API Selection:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isBumperdotcom = true"})," \u2192 Use Bumper.com API"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"isBumperdotcom = false"})," \u2192 Use ChromeData API"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Return Value:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"true"})," \u2192 VIN decoded successfully, paint code found"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"false"})," \u2192 Decode failed (invalid VIN, no match, API error)"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"4-success-path",children:"4. Success Path"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'if (isVinValidWithPaintCode) {\n\t// Store paint code in localStorage\n\thandleInsertLocalStoragePaintOption();\n\n\t// Auto-check "Use stored code" option\n\tconst checkboxUseStoredCode = document.getElementById(\n\t\t"checkbox-paint-code-local-storage"\n\t);\n\tcheckboxUseStoredCode.checked = true;\n\n\t// Hide prompts\n\thideGiveUsYourVinMsg();\n\n\t// Mark decoder as exhausted (no more attempts needed)\n\tisVinDecoderExhausted = true;\n\n\t// Hide this VIN input (successful, don\'t need it anymore)\n\thideVinInputIfVinExist();\n\n\t// Hide paint code dropdown (auto-selected)\n\thidePaintCodeWrapper();\n\n\t// Enable checkout if auto-selected variant is available\n\tif (autoSelectedBanned) {\n\t\tenableAddToCartButton();\n\t}\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Success Flow:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Paint code stored in localStorage (garage)"}),"\n",(0,s.jsx)(n.li,{children:'"Use my stored paint code" radio automatically checked'}),"\n",(0,s.jsx)(n.li,{children:"VIN input hidden"}),"\n",(0,s.jsx)(n.li,{children:"Paint code dropdown hidden"}),"\n",(0,s.jsx)(n.li,{children:"Add to Cart enabled (if variant available)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"5-failure-path",children:"5. Failure Path"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"  else {\n    // Track failed attempt\n    attemptedDecodedVins.push(vinInput);\n\n    // Disable submit for this instance\n    vinSubmitBtn.disabled = true;\n\n    // Still hide input (failed, can't retry in same instance)\n    hideVinInputIfVinExist();\n  }\n"})}),"\n",(0,s.jsx)(n.h4,{id:"6-max-attempts-handling",children:"6. Max Attempts Handling"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'updateProgressHeaderColors();\n\nif (attemptedDecodedVins.length >= decodeMaxAttempts) {\n\tisVinDecoderExhausted = true;\n\n\tif (successfulVinDecoding === false) {\n\t\t// All 3 attempts failed\n\t\tvinInputElem.value = "";\n\t\tvinInputElem.disabled = true;\n\n\t\t// Force user to manually select paint code\n\t\tresortToForceSelectCode();\n\n\t\t// Show instructional message\n\t\tformulateForcePaintCodeSelectMsg(\n\t\t\tvinInput,\n\t\t\t"",\n\t\t\tforceSelectMsgStart,\n\t\t\tforceSelectMsgEnd,\n\t\t\t3\n\t\t);\n\n\t\thideGiveUsYourVinMsg();\n\t\thidePaintCodeAppContainer(false);\n\t\tdisableAddToCartButton();\n\t} else {\n\t\t// At least one attempt succeeded\n\t\tenableAddToCartButton();\n\t}\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Max Attempts Rules:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Variable: ",(0,s.jsx)(n.code,{children:"decodeMaxAttempts"})," (typically 3)"]}),"\n",(0,s.jsxs)(n.li,{children:["Array: ",(0,s.jsx)(n.code,{children:"attemptedDecodedVins[]"})," tracks all submitted VINs"]}),"\n",(0,s.jsx)(n.li,{children:"After 3 failures: Force manual paint code selection"}),"\n",(0,s.jsx)(n.li,{children:"Success within 3 attempts: Allow checkout"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"7-cleanup",children:"7. Cleanup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"  vinSubmitBtn.classList.remove('vin-decoder-submit-btn--loading');\n  vinSubmitBtn.textContent = vinSubmitBtn._originalText || '{{ 'vin_decoder_product_page.submit' | t }}';\n  updateProgressHeaderColors();\n});\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"key-functions-reference",children:"Key Functions Reference"}),"\n",(0,s.jsx)(n.h3,{id:"handlevinchange",children:"handleVinChange()"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location:"})," ",(0,s.jsx)(n.code,{children:"global-library.js"})," (line ~985)"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Rate limiting and retry prevention"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"event"})," - Input event object"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"functionLocation"})," - Location ID (e.g., 3)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"errorMsg"})," - Error message to display"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"true"})," - User is retrying (stop further processing)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"false"})," - Continue normal processing"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Logic:"}),"\nPrevents users from continuously retrying after failed attempts by tracking state."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"handlevindecode",children:"handleVinDecode()"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location:"})," ",(0,s.jsx)(n.code,{children:"global-library.js"})," (line ~2473)"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Core VIN decode API call and response handling"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"async function handleVinDecode(\n  vinInput,              // String: 17-char VIN\n  licensePlate,          // String: License plate (or empty)\n  additionalParam,       // String: Extra param\n  maxAttempts,           // Number: Max decode attempts (3)\n  isBumperdotcom,        // Boolean: API selection\n  failed3timesmsg,       // String: Error message translations...\n  noResults,\n  searchBtn,\n  tailoredSuccessMessage,\n  failedAttempt,\n  remainingAttempts,\n  vinDecoderFirstMsg,\n  vinDecoderEndMsg,\n  forceSelectMsgStart,\n  forceSelectMsgEnd\n)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Promise<boolean>"})," - True if paint code found and matched"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Make API request to decode VIN"}),"\n",(0,s.jsx)(n.li,{children:"Parse response for paint codes"}),"\n",(0,s.jsx)(n.li,{children:"Match paint codes to available product variants"}),"\n",(0,s.jsx)(n.li,{children:"Auto-select matching variant"}),"\n",(0,s.jsx)(n.li,{children:"Handle mismatch scenarios"}),"\n",(0,s.jsx)(n.li,{children:"Show appropriate messages"}),"\n",(0,s.jsx)(n.li,{children:"Return success/failure status"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"handleinsertlocalstoragepaintoption",children:"handleInsertLocalStoragePaintOption()"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location:"})," ",(0,s.jsx)(n.code,{children:"global-library.js"})," (line ~2809)"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Manage stored VIN/paint code from garage (localStorage)"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"String"})," - Paint code color name (or empty)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Check localStorage for garage data"}),"\n",(0,s.jsx)(n.li,{children:"Find first vehicle entry"}),"\n",(0,s.jsx)(n.li,{children:"Extract paint code and color"}),"\n",(0,s.jsx)(n.li,{children:'Create "Use my stored code" radio option'}),"\n",(0,s.jsx)(n.li,{children:"Display stored information to user"}),"\n",(0,s.jsx)(n.li,{children:"Return color name"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Storage Format:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'garage: [\n\t{\n\t\tvin: "1HGBH41JXMN109186",\n\t\tpaintCode: "NH731P",\n\t\tcolor: "Silver Metallic",\n\t\t// ... other vehicle data\n\t},\n];\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"hidevininputifvinexist",children:"hideVinInputIfVinExist()"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location:"})," ",(0,s.jsx)(n.code,{children:"product-page-component-library.js"})," (line ~796)"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Hide VIN input sections when VIN already provided"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Logic:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'function hideVinInputIfVinExist() {\n\t// Check if VIN exists in garage/storage\n\tif (hasVinOnFile) {\n\t\t// Hide both instances\n\t\tdocument\n\t\t\t.getElementById("vin-decoder-after-selection")\n\t\t\t?.classList.add("hidden");\n\t\tdocument.getElementById("vin-decoder-option")?.classList.add("hidden");\n\n\t\t// Add body class for CSS targeting\n\t\tdocument.body.classList.add("has-vin-on-file");\n\t}\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"CSS Impact:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-css",children:".has-vin-on-file #vin-after-paint-code-selection-byvin {\n\tdisplay: none !important;\n}\n.has-vin-on-file #vin-after-paint-code-selection-after {\n\tdisplay: none !important;\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"hidepaintcodewrapper",children:"hidePaintCodeWrapper()"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location:"})," ",(0,s.jsx)(n.code,{children:"product-page-component-library.js"})," (line ~411)"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Hide paint code dropdown when auto-selected"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Logic:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'function hidePaintCodeWrapper() {\n\tconst paintCodeWrapper = document.querySelector(".paint-code-wrapper");\n\n\tif (paintCodeWrapper) {\n\t\tpaintCodeWrapper.classList.remove("show");\n\t\t// Triggers CSS transition to collapse\n\t}\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"CSS Transition:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-css",children:".paint-code-wrapper {\n\tmax-height: 0;\n\toverflow: hidden;\n\topacity: 0;\n\ttransition: max-height 0.5s ease, opacity 0.5s ease, margin-top 0.7s ease;\n}\n\n.paint-code-wrapper.show {\n\tmax-height: fit-content;\n\topacity: 1;\n\tmargin-top: 3px;\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"checkvinfitment",children:"checkVinFitment()"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Purpose:"})," Validate VIN against product fitment rules"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'{\n  isCharPresent: boolean,      // Does VIN start with allowed char?\n  inclusionChars: string,      // Allowed starting characters (e.g., "1,4,5")\n  inclusionCountry: string,    // Country for inclusion (e.g., "USA")\n  exclusionChars: string,      // Disallowed starting characters\n  exclusionCountry: string,    // Country for exclusion\n  groupIndex: string           // Fitment group identifier\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Product only fits US vehicles\ncheckVinFitment("5YJSA1E14HF250864");\n// Returns: { isCharPresent: true, inclusionChars: "1,4,5", inclusionCountry: "USA", ... }\n\ncheckVinFitment("JTNKARJE9HJ568890"); // Japanese VIN\n// Returns: { isCharPresent: false, inclusionChars: "1,4,5", inclusionCountry: "USA", ... }\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"state-management",children:"State Management"}),"\n",(0,s.jsx)(n.h3,{id:"global-variables-shared-across-instances",children:"Global Variables (Shared Across Instances)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Attempt tracking\nattemptedDecodedVins = []; // Array of VINs already submitted\ndecodeMaxAttempts = 3; // Maximum decode attempts allowed\nisVinDecoderExhausted = false; // True after max attempts reached\nsuccessfulVinDecoding = false; // True if any decode succeeded\n\n// Paint code state\nwindow.isPaintUnavailable = false; // True if selected paint unavailable\nselectedVariantUnavailable = false; // True if variant out of stock\nautoSelectedBanned = false; // True if auto-selected variant is banned/restricted\n\n// UI state\nhasVinOnFile = false; // True if VIN in localStorage garage\nfirstVehicleColor = ""; // Color from garage first vehicle\n'})}),"\n",(0,s.jsx)(n.h3,{id:"instance-specific-variables-iife-scoped",children:"Instance-Specific Variables (IIFE Scoped)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'(function () {\n\tconst instance = "after"; // or \'byvin\'\n\tconst vinInputByInstance = document.getElementById(\n\t\t`vin-decoder-textbox-for-verification-${instance}`\n\t);\n\tconst wrapper = document.getElementById(\n\t\t`vin-decoder-textbox-for-verification-wrapper-${instance}`\n\t);\n\tconst vinErrorMsgContainer = wrapper.querySelector(\n\t\t".vin-error-message-container"\n\t);\n\tconst vinSubmitBtn = document.querySelector(`[data-instance="${instance}"]`);\n\n\t// These variables are unique to each instance\'s closure\n})();\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"ui-visibility-rules",children:"UI Visibility Rules"}),"\n",(0,s.jsx)(n.h3,{id:"when-after-instance-is-shown",children:'When "After" Instance is Shown'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Checkbox: \"Select a paint code\"\ndocument.getElementById('checkbox-select-paint-option').checked === true\n    \u2193\n// Show VIN input after paint selection\ndocument.getElementById('vin-decoder-after-selection').style.display = 'block';\n"})}),"\n",(0,s.jsx)(n.h3,{id:"when-byvin-instance-is-shown",children:'When "ByVin" Instance is Shown'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Checkbox: \"Find paint code using VIN\"\ndocument.getElementById('checkbox-get-paint-code-with-vin').checked === true\n    \u2193\n// Show paint code app container\ndocument.getElementById('paintcode-app-container').classList.add('show');\n    \u2193\n// Show VIN input inside container\ndocument.getElementById('vin-decoder-option').style.display = 'block';\n"})}),"\n",(0,s.jsx)(n.h3,{id:"when-both-are-hidden",children:"When Both are Hidden"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// VIN already on file in garage\nhasVinOnFile === true\n    \u2193\ndocument.body.classList.add('has-vin-on-file');\n    \u2193\n// CSS hides both instances\n.has-vin-on-file #vin-after-paint-code-selection-byvin { display: none !important; }\n.has-vin-on-file #vin-after-paint-code-selection-after { display: none !important; }\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"error-message-hierarchy",children:"Error Message Hierarchy"}),"\n",(0,s.jsx)(n.h3,{id:"validation-error-real-time",children:"Validation Error (Real-time)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div class="vin-validation-error" id="vin-validation-error-{instance}">\n\tVIN must start with "1, 4, or 5"\n</div>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Shown During:"})," Typing (input event)\n",(0,s.jsx)(n.strong,{children:"Hidden When:"})," VIN becomes valid or reaches 17 characters"]}),"\n",(0,s.jsx)(n.h3,{id:"failed-attempt-after-submit",children:"Failed Attempt (After Submit)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div class="vin-decoder-failed-attempt">\n\tVIN decode failed. Please verify and try again.\n</div>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Shown After:"})," Submit button clicked, API returns failure\n",(0,s.jsx)(n.strong,{children:"Hidden When:"})," User types in input field again"]}),"\n",(0,s.jsx)(n.h3,{id:"remaining-attempts",children:"Remaining Attempts"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div class="vin-decoder-remaining-attempts">You have 2 attempts remaining.</div>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Shown After:"})," Failed submit\n",(0,s.jsx)(n.strong,{children:"Updated On:"})," Each failed attempt"]}),"\n",(0,s.jsx)(n.h3,{id:"exhausted-attempts-3-failures",children:"Exhausted Attempts (3 Failures)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div class="vin-decoder-submission-failed-message">\n\tUnable to decode VIN after 3 attempts. Please select your paint code manually.\n</div>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Shown After:"})," 3rd failed attempt\n",(0,s.jsx)(n.strong,{children:"Permanent Until:"})," Page reload"]}),"\n",(0,s.jsx)(n.h3,{id:"success-message",children:"Success Message"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div class="vin-decoder-submission-success-message">\n\tVIN decoded successfully! Paint code selected.\n</div>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Shown After:"})," Successful decode\n",(0,s.jsx)(n.strong,{children:"Auto-hidden After:"})," 3-5 seconds (varies by implementation)"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"complete-user-journey-examples",children:"Complete User Journey Examples"}),"\n",(0,s.jsx)(n.h3,{id:"journey-1-success-on-first-try-byvin-instance",children:'Journey 1: Success on First Try ("ByVin" Instance)'}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"User lands on product page"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Paint options shown"}),"\n",(0,s.jsx)(n.li,{children:"No VIN input visible yet"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'User selects "Find paint code using VIN" radio'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"checkbox-get-paint-code-with-vin.checked = true\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"#paintcode-app-container"})," transitions to visible"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"#vin-decoder-option"})," (byvin instance) displays"]}),"\n",(0,s.jsx)(n.li,{children:"Two-tone warning message shown"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'User types VIN: "1HGBH41JXMN109186"'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Character validation runs on each keystroke"}),"\n",(0,s.jsx)(n.li,{children:"Invalid chars filtered (I, O, Q, special chars)"}),"\n",(0,s.jsx)(n.li,{children:"Submit button remains disabled until 17 chars"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"At 17 characters"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Submit button enables"}),"\n",(0,s.jsx)(n.li,{children:"No validation errors shown"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"User clicks Submit"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Loading spinner appears"}),"\n",(0,s.jsxs)(n.li,{children:["API call: ",(0,s.jsx)(n.code,{children:'handleVinDecode("1HGBH41JXMN109186", ...)'})]}),"\n",(0,s.jsx)(n.li,{children:'Response: Paint code "NH731P"'}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Success Processing"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'Paint code "NH731P" matched to variant'}),"\n",(0,s.jsx)(n.li,{children:"Variant auto-selected in dropdown"}),"\n",(0,s.jsx)(n.li,{children:"VIN stored in garage (localStorage)"}),"\n",(0,s.jsx)(n.li,{children:"Success message shown briefly"}),"\n",(0,s.jsxs)(n.li,{children:["VIN input hidden (",(0,s.jsx)(n.code,{children:"hideVinInputIfVinExist()"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Paint dropdown hidden (",(0,s.jsx)(n.code,{children:"hidePaintCodeWrapper()"}),")"]}),"\n",(0,s.jsx)(n.li,{children:'"Use my stored code" radio checked'}),"\n",(0,s.jsx)(n.li,{children:"Add to Cart button enabled"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"User can proceed to checkout"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"journey-2-failure-after-3-attempts-byvin-instance",children:'Journey 2: Failure After 3 Attempts ("ByVin" Instance)'}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'User selects "Find paint code using VIN"'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ByVin instance shown"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'Attempt 1: User enters "5YJSA1E14HF250864"'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Submit \u2192 API call \u2192 No matching paint code"}),"\n",(0,s.jsx)(n.li,{children:'Error: "Failed attempt. You have 2 remaining attempts."'}),"\n",(0,s.jsx)(n.li,{children:"Submit button disabled"}),"\n",(0,s.jsx)(n.li,{children:"VIN cleared or disabled"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'Attempt 2: User enters "2HGFG12848H501234"'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Submit \u2192 API call \u2192 No matching paint code"}),"\n",(0,s.jsx)(n.li,{children:'Error: "Failed attempt. You have 1 remaining attempt."'}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'Attempt 3: User enters "19UUA66258A012345"'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Submit \u2192 API call \u2192 No matching paint code"}),"\n",(0,s.jsx)(n.li,{children:'Error: "Unable to decode VIN after 3 attempts."'}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"isVinDecoderExhausted = true"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"attemptedDecodedVins.length === 3"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"System Fallback"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"resortToForceSelectCode();\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"VIN input disabled"}),"\n",(0,s.jsx)(n.li,{children:"Paint code dropdown shown (force manual selection)"}),"\n",(0,s.jsx)(n.li,{children:'Message: "Please select your paint code from the dropdown"'}),"\n",(0,s.jsx)(n.li,{children:"Add to Cart remains disabled"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"User manually selects paint code"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add to Cart enables"}),"\n",(0,s.jsx)(n.li,{children:"User can checkout (with caveat they manually selected)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"journey-3-optional-vin-after-paint-selection-after-instance",children:'Journey 3: Optional VIN After Paint Selection ("After" Instance)'}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'User selects "Select a paint code" radio'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Paint code dropdown shown"}),"\n",(0,s.jsx)(n.li,{children:"No VIN input yet"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'User selects paint code "NH731P - Silver Metallic"'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Variant selected"}),"\n",(0,s.jsx)(n.li,{children:"Price updates"}),"\n",(0,s.jsx)(n.li,{children:"Add to Cart enables"}),"\n",(0,s.jsx)(n.li,{children:'"After" instance VIN input appears'}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'Label shows: "Provide VIN to guarantee fit (optional)"'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"User CAN checkout without VIN"}),"\n",(0,s.jsx)(n.li,{children:"Or user CAN provide VIN for verification"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"User chooses to provide VIN"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'Types: "1HGBH41JXMN109186"'}),"\n",(0,s.jsx)(n.li,{children:"Submit \u2192 API validates VIN matches paint code"}),"\n",(0,s.jsx)(n.li,{children:"Success: VIN stored, order enhanced"}),"\n",(0,s.jsx)(n.li,{children:"Mismatch: Warning shown, user can proceed anyway"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"User checks out"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Order properties include VIN"}),"\n",(0,s.jsx)(n.li,{children:"Better fulfillment accuracy"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"technical-notes",children:"Technical Notes"}),"\n",(0,s.jsx)(n.h3,{id:"why-iife-immediately-invoked-function-expression",children:"Why IIFE (Immediately Invoked Function Expression)?"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'(function () {\n\tconst instance = "{{ instance_suffix }}";\n\t// ... instance-specific code\n})();\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Reason:"})," JavaScript variable scoping"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Without IIFE:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Both instances would share the same ",(0,s.jsx)(n.code,{children:"instance"})," variable"]}),"\n",(0,s.jsx)(n.li,{children:"Event listeners would reference the last value (always 'byvin')"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"With IIFE:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Each instance captures its own ",(0,s.jsx)(n.code,{children:"instance"})," value in closure"]}),"\n",(0,s.jsx)(n.li,{children:"Event listeners correctly reference their own elements"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"instance-isolation-guarantees",children:"Instance Isolation Guarantees"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Aspect"}),(0,s.jsx)(n.th,{children:"Isolation Method"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"HTML Elements"}),(0,s.jsxs)(n.td,{children:["Unique IDs via ",(0,s.jsx)(n.code,{children:"{{ instance_suffix }}"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"JavaScript Variables"}),(0,s.jsx)(n.td,{children:"IIFE closure scope"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Event Listeners"}),(0,s.jsx)(n.td,{children:"Instance-specific selectors"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CSS Styles"}),(0,s.jsx)(n.td,{children:"Class-based (shared) + ID overrides"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"API Calls"}),(0,s.jsx)(n.td,{children:"Shared functions with instance params"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u274c Incorrect:"})," Querying without instance"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'const vinInput = document.getElementById(\n\t"vin-decoder-textbox-for-verification"\n);\n// Returns only first instance, ignores second\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u2705 Correct:"})," Instance-specific query"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const vinInput = document.getElementById(\n\t`vin-decoder-textbox-for-verification-${instance}`\n);\n// Returns correct instance element\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"debugging-guide",children:"Debugging Guide"}),"\n",(0,s.jsx)(n.h3,{id:"check-which-instance-is-active",children:"Check Which Instance is Active"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// In browser console\ndocument.querySelectorAll(".vin-decoder-wrapper.show").forEach((el) => {\n\tconsole.log("Active instance:", el.id);\n});\n\n// Output examples:\n// Active instance: vin-decoder-textbox-for-verification-wrapper-after\n// Active instance: vin-decoder-textbox-for-verification-wrapper-byvin\n'})}),"\n",(0,s.jsx)(n.h3,{id:"verify-instance-event-listeners",children:"Verify Instance Event Listeners"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Check if input has listeners\ngetEventListeners(\n\tdocument.getElementById(\"vin-decoder-textbox-for-verification-after\")\n);\n\n// Should show 'input' event listener\n"})}),"\n",(0,s.jsx)(n.h3,{id:"track-vin-decode-state",children:"Track VIN Decode State"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// In console\nconsole.log("Attempted VINs:", attemptedDecodedVins);\nconsole.log("Max attempts:", decodeMaxAttempts);\nconsole.log("Exhausted?", isVinDecoderExhausted);\nconsole.log("Success?", successfulVinDecoding);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"monitor-api-calls",children:"Monitor API Calls"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Watch network tab for:\n// ChromeData API: /apps/vin-decoder-proxy\n// Bumper.com API: /apps/bumper-api-proxy\n\n// Check request payload:\n{\n  vin: "1HGBH41JXMN109186",\n  // ... other params\n}\n\n// Check response:\n{\n  paintCode: "NH731P",\n  color: "Silver Metallic",\n  // ... other vehicle data\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"summary-comparison-table",children:"Summary Comparison Table"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:'"After" Instance'}),(0,s.jsx)(n.th,{children:'"ByVin" Instance'})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Instance ID"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"after"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"byvin"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Parent Container"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"#vin-decoder-after-selection"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"#paintcode-app-container > #vin-decoder-option"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"When Shown"})}),(0,s.jsx)(n.td,{children:"After paint code selected"}),(0,s.jsx)(n.td,{children:'When "Use VIN" radio checked'})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Purpose"})}),(0,s.jsx)(n.td,{children:"Verify/enhance order"}),(0,s.jsx)(n.td,{children:"Decode VIN to find paint code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Required?"})}),(0,s.jsx)(n.td,{children:"Usually optional"}),(0,s.jsx)(n.td,{children:"Required for this flow"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"API Purpose"})}),(0,s.jsx)(n.td,{children:"Validate match"}),(0,s.jsx)(n.td,{children:"Decode and auto-select"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Success Action"})}),(0,s.jsx)(n.td,{children:"Store VIN, hide input"}),(0,s.jsx)(n.td,{children:"Store VIN, hide input + dropdown"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Failure Action"})}),(0,s.jsx)(n.td,{children:"Allow checkout anyway"}),(0,s.jsx)(n.td,{children:"Force manual selection after 3 fails"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Add to Cart"})}),(0,s.jsx)(n.td,{children:"Already enabled"}),(0,s.jsx)(n.td,{children:"Enables after success"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"The VIN decoder input box system elegantly handles two distinct user flows using a single reusable component. The instance parameter system ensures complete isolation between the two entry points while sharing validation logic and API calls."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key Takeaways:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Instance Isolation:"})," IIFE closures prevent variable collision"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Unique IDs:"})," All elements namespaced with instance suffix"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Shared Logic:"})," Core functions (handleVinDecode, validation) are reusable"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"State Management:"})," Global variables track attempts across all instances"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Progressive Enhancement:"})," Optional VIN after paint selection, required VIN for decode flow"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Error Recovery:"})," 3-attempt limit with manual fallback option"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Maintenance Tips:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Always use instance-specific selectors in JavaScript"}),"\n",(0,s.jsx)(n.li,{children:"Test both instances separately when making changes"}),"\n",(0,s.jsx)(n.li,{children:"Verify IIFE closure captures instance correctly"}),"\n",(0,s.jsx)(n.li,{children:"Check global state variables don't leak between instances"}),"\n",(0,s.jsx)(n.li,{children:"Ensure API calls handle both bumper.com and ChromeData paths"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Document Version:"})," 1.0",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Last Updated:"})," December 24, 2025",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Related Files:"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"snippets/vin-decoder-input-box.liquid"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"snippets/product-page-paint-options.liquid"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"assets/global-library.js"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"assets/product-page-component-library.js"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453(e,n,i){i.d(n,{R:()=>l,x:()=>a});var t=i(6540);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);