"use strict";(globalThis.webpackChunkpartify_usa=globalThis.webpackChunkpartify_usa||[]).push([[6682],{2436(e,n,i){i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"pages/product-page/add-to-cart-quality-reenable","title":"Add to Cart Re-enable on Quality Change","description":"Overview","source":"@site/docs/pages/product-page/add-to-cart-quality-reenable.md","sourceDirName":"pages/product-page","slug":"/pages/product-page/add-to-cart-quality-reenable","permalink":"/partify-theme-docs/docs/pages/product-page/add-to-cart-quality-reenable","draft":false,"unlisted":false,"editUrl":"https://github.com/partify/partify-theme-docs/tree/main/docs/pages/product-page/add-to-cart-quality-reenable.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"add-to-cart-quality-reenable","title":"Add to Cart Re-enable on Quality Change","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Auto-Select Quality Feature","permalink":"/partify-theme-docs/docs/pages/product-page/auto-select-quality"},"next":{"title":"Contribution","permalink":"/partify-theme-docs/docs/category/contribution"}}');var s=i(4848),l=i(8453);const a={id:"add-to-cart-quality-reenable",title:"Add to Cart Re-enable on Quality Change",sidebar_position:4},d="Add to Cart Re-enable on Quality Change",r={},o=[{value:"Overview",id:"overview",level:2},{value:"Bug Summary",id:"bug-summary",level:3},{value:"Fix Summary",id:"fix-summary",level:3},{value:"Root Cause",id:"root-cause",level:2},{value:"Initial Page Load Behavior",id:"initial-page-load-behavior",level:3},{value:"Quality Selection Behavior (Before Fix)",id:"quality-selection-behavior-before-fix",level:3},{value:"Why Variant ID Updates Were Insufficient",id:"why-variant-id-updates-were-insufficient",level:3},{value:"Implementation Details",id:"implementation-details",level:2},{value:"File Modified",id:"file-modified",level:3},{value:"Function Modified",id:"function-modified",level:3},{value:"Changes Made",id:"changes-made",level:3},{value:"Key Logic Changes",id:"key-logic-changes",level:3},{value:"Data Attribute Source",id:"data-attribute-source",level:3},{value:"Behavior Changes",id:"behavior-changes",level:2},{value:"Before vs After",id:"before-vs-after",level:3},{value:"User Flow Example (Primary Fix)",id:"user-flow-example-primary-fix",level:3},{value:"What This Fix Does NOT Change",id:"what-this-fix-does-not-change",level:2},{value:"Unchanged Gating Mechanisms",id:"unchanged-gating-mechanisms",level:3},{value:"Unchanged Button States",id:"unchanged-button-states",level:3},{value:"Technical Notes",id:"technical-notes",level:2},{value:"Why <code>data-available</code> Attribute?",id:"why-data-available-attribute",level:3},{value:"Why Not Use <code>window.productVariants</code>?",id:"why-not-use-windowproductvariants",level:3},{value:"Button References",id:"button-references",level:3},{value:"Testing Recommendations",id:"testing-recommendations",level:2},{value:"Manual Testing Checklist",id:"manual-testing-checklist",level:3},{value:"Edge Cases",id:"edge-cases",level:3},{value:"Deployment Notes",id:"deployment-notes",level:2},{value:"Files Changed",id:"files-changed",level:3},{value:"No Database Changes Required",id:"no-database-changes-required",level:3},{value:"Rollback Procedure",id:"rollback-procedure",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"add-to-cart-re-enable-on-quality-change",children:"Add to Cart Re-enable on Quality Change"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"This document describes the fix for a bug where the Add to Cart button remained disabled after a user selected an in-stock quality option (e.g., CAPA, OEM) when the initially loaded base product was out of stock."}),"\n",(0,s.jsx)(n.h3,{id:"bug-summary",children:"Bug Summary"}),"\n",(0,s.jsx)(n.p,{children:"When a product page loaded with an out-of-stock base variant:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The Add to Cart button was correctly disabled with ",(0,s.jsx)(n.code,{children:"disabled=true"})," and the ",(0,s.jsx)(n.code,{children:"disabled-oos"})," CSS class"]}),"\n",(0,s.jsxs)(n.li,{children:["When the user selected an in-stock quality option, the hidden variant ID input (",(0,s.jsx)(n.code,{children:'[name="id"]'}),") updated correctly"]}),"\n",(0,s.jsxs)(n.li,{children:["However, the button remained disabled because the ",(0,s.jsx)(n.code,{children:"disabled-oos"})," state was never re-evaluated"]}),"\n",(0,s.jsx)(n.li,{children:"This blocked legitimate purchases of in-stock variants"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"fix-summary",children:"Fix Summary"}),"\n",(0,s.jsxs)(n.p,{children:["Modified the ",(0,s.jsx)(n.code,{children:"enableAddToCartButton()"})," function in ",(0,s.jsx)(n.code,{children:"product-page-component-library.js"})," to check the availability of the currently selected quality option before enabling the button, rather than relying solely on the base product's availability state (",(0,s.jsx)(n.code,{children:"window.blockAddToCart"}),")."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"root-cause",children:"Root Cause"}),"\n",(0,s.jsx)(n.h3,{id:"initial-page-load-behavior",children:"Initial Page Load Behavior"}),"\n",(0,s.jsx)(n.p,{children:"When a product page loads with an out-of-stock base product:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Shopify sets ",(0,s.jsx)(n.code,{children:"window.blockAddToCart = true"})," (based on ",(0,s.jsx)(n.code,{children:"product.available"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["The Add to Cart button is disabled: ",(0,s.jsx)(n.code,{children:"button.disabled = true"})]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"disabled-oos"})," CSS class is added to the button"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"quality-selection-behavior-before-fix",children:"Quality Selection Behavior (Before Fix)"}),"\n",(0,s.jsx)(n.p,{children:"When a user selected a different quality option (e.g., switching from out-of-stock Aftermarket to in-stock CAPA):"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 The hidden variant ID input updated correctly"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 The price display updated correctly"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Quality-specific UI elements updated correctly"}),"\n",(0,s.jsxs)(n.li,{children:["\u274c The ",(0,s.jsx)(n.code,{children:"enableAddToCartButton()"})," function checked ",(0,s.jsx)(n.code,{children:"window.blockAddToCart"})," (still ",(0,s.jsx)(n.code,{children:"true"})," for the base product)"]}),"\n",(0,s.jsx)(n.li,{children:"\u274c The function returned early without enabling the button"}),"\n",(0,s.jsxs)(n.li,{children:["\u274c The ",(0,s.jsx)(n.code,{children:"disabled-oos"})," class remained on the button"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Result:"})," Button stayed disabled even though the selected variant was in stock."]}),"\n",(0,s.jsx)(n.h3,{id:"why-variant-id-updates-were-insufficient",children:"Why Variant ID Updates Were Insufficient"}),"\n",(0,s.jsxs)(n.p,{children:["The hidden input ",(0,s.jsx)(n.code,{children:'[name="id"]'})," correctly reflected the selected in-stock variant, but the form submission was blocked client-side because:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The button had ",(0,s.jsx)(n.code,{children:"disabled=true"})," (preventing clicks)"]}),"\n",(0,s.jsx)(n.li,{children:"Browser form submission ignores inputs from disabled buttons"}),"\n",(0,s.jsx)(n.li,{children:"No re-evaluation logic existed to sync button state with the selected variant's availability"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,s.jsx)(n.h3,{id:"file-modified",children:"File Modified"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"assets/product-page-component-library.js"})})}),"\n",(0,s.jsx)(n.h3,{id:"function-modified",children:"Function Modified"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"enableAddToCartButton()"})})," (lines ~1204-1213)"]}),"\n",(0,s.jsx)(n.h3,{id:"changes-made",children:"Changes Made"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Before:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"function enableAddToCartButton() {\n\t// Never allow enabling when product is globally blocked (OOS)\n\tif (window.blockAddToCart) {\n\t\tdisableAddToCartButton();\n\t\treturn;\n\t}\n\n\tif (currentAddToCartBtnLibrary) currentAddToCartBtnLibrary.disabled = false;\n\tif (addToCartStickyLibrary) addToCartStickyLibrary.disabled = false;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"After:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'function enableAddToCartButton() {\n\t// Check if a quality is selected and if it\'s available\n\tconst selectedQuality = document.querySelector(\n\t\t\'input[name="quality_type"]:checked\'\n\t);\n\tconst isQualityAvailable = selectedQuality\n\t\t? selectedQuality.getAttribute("data-available") === "true"\n\t\t: true;\n\n\t// Block if selected quality is out of stock OR if base product is blocked AND no quality selected\n\tif (!isQualityAvailable || (window.blockAddToCart && !selectedQuality)) {\n\t\tdisableAddToCartButton();\n\t\treturn;\n\t}\n\n\tif (currentAddToCartBtnLibrary) {\n\t\tcurrentAddToCartBtnLibrary.disabled = false;\n\t\tcurrentAddToCartBtnLibrary.classList.remove("disabled-oos");\n\t}\n\tif (addToCartStickyLibrary) {\n\t\taddToCartStickyLibrary.disabled = false;\n\t\taddToCartStickyLibrary.classList.remove("disabled-oos");\n\t}\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"key-logic-changes",children:"Key Logic Changes"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Quality Availability Check"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Queries the DOM for the currently selected quality radio button: ",(0,s.jsx)(n.code,{children:'input[name="quality_type"]:checked'})]}),"\n",(0,s.jsxs)(n.li,{children:["Reads the ",(0,s.jsx)(n.code,{children:"data-available"})," attribute (set by Liquid template based on product availability)"]}),"\n",(0,s.jsxs)(n.li,{children:["If no quality is selected, defaults to ",(0,s.jsx)(n.code,{children:"true"})," (allows enabling for products without quality options)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Conditional Blocking"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Blocks if selected quality is unavailable (",(0,s.jsx)(n.code,{children:"!isQualityAvailable"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Blocks if base product is OOS AND no quality has been selected"}),"\n",(0,s.jsx)(n.li,{children:"Otherwise, proceeds to enable the button"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Class Management"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Explicitly removes ",(0,s.jsx)(n.code,{children:"disabled-oos"})," class when enabling"]}),"\n",(0,s.jsx)(n.li,{children:"Ensures button can be styled correctly for available states"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"data-attribute-source",children:"Data Attribute Source"}),"\n",(0,s.jsxs)(n.p,{children:["Quality radio buttons are rendered with ",(0,s.jsx)(n.code,{children:"data-available"})," in ",(0,s.jsx)(n.code,{children:"snippets/quality-options-radio-btns.liquid"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-liquid",children:'<input\n  type="radio"\n  name="quality_type"\n  value="aftermarket"\n  {% if aftermarket_product.available %}\n    data-available="true"\n  {% else %}\n    data-available="false"\n    disabled\n  {% endif %}\n>\n'})}),"\n",(0,s.jsx)(n.p,{children:"This attribute reflects the Shopify product availability for that specific quality variant."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"behavior-changes",children:"Behavior Changes"}),"\n",(0,s.jsx)(n.h3,{id:"before-vs-after",children:"Before vs After"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Scenario"}),(0,s.jsx)(n.th,{children:"User Action"}),(0,s.jsx)(n.th,{children:"Before Fix"}),(0,s.jsx)(n.th,{children:"After Fix"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"OOS Base \u2192 In-Stock Quality"})}),(0,s.jsxs)(n.td,{children:["1. Land on OOS Aftermarket product",(0,s.jsx)("br",{}),"2. Select CAPA (in stock)",(0,s.jsx)("br",{}),"3. Select paint option"]}),(0,s.jsx)(n.td,{children:"Button stays disabled \u274c"}),(0,s.jsx)(n.td,{children:"Button enables after paint selection \u2705"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Direct In-Stock Quality Landing"})}),(0,s.jsxs)(n.td,{children:["1. Navigate to ",(0,s.jsx)(n.code,{children:"/products/...?variant=CAPA_ID"}),(0,s.jsx)("br",{}),"2. Select paint option"]}),(0,s.jsx)(n.td,{children:"Button enables correctly \u2705"}),(0,s.jsx)(n.td,{children:"Button enables correctly \u2705 (no change)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"In-Stock Base \u2192 OOS Quality"})}),(0,s.jsxs)(n.td,{children:["1. Land on in-stock product",(0,s.jsx)("br",{}),"2. Select OOS quality"]}),(0,s.jsx)(n.td,{children:"Button disables correctly \u2705"}),(0,s.jsx)(n.td,{children:"Button disables correctly \u2705 (no change)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Quality Switch Between In-Stock Options"})}),(0,s.jsxs)(n.td,{children:["1. Select CAPA (in stock)",(0,s.jsx)("br",{}),"2. Switch to OEM (in stock)"]}),(0,s.jsx)(n.td,{children:"Button stays enabled \u2705"}),(0,s.jsx)(n.td,{children:"Button stays enabled \u2705 (no change)"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"user-flow-example-primary-fix",children:"User Flow Example (Primary Fix)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Scenario:"})," Customer wants to purchase an in-stock CAPA variant when Aftermarket is out of stock."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Page Load"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Base product: Aftermarket (Out of Stock)"}),"\n",(0,s.jsxs)(n.li,{children:["Button state: Disabled, ",(0,s.jsx)(n.code,{children:"disabled-oos"})," class present"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"window.blockAddToCart = true"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Select CAPA Quality"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Quality radio button: ",(0,s.jsx)(n.code,{children:'data-available="true"'})]}),"\n",(0,s.jsx)(n.li,{children:"Variant ID updates to CAPA variant"}),"\n",(0,s.jsx)(n.li,{children:"Button remains disabled (waiting for paint option)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:'Select Paint Option (e.g., "Unpainted")'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"enableAddToCartButton()"})," is called"]}),"\n",(0,s.jsxs)(n.li,{children:["Function checks ",(0,s.jsx)(n.code,{children:'data-available="true"'})," on CAPA radio"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Fix:"})," Function bypasses ",(0,s.jsx)(n.code,{children:"window.blockAddToCart"})," check because quality is available"]}),"\n",(0,s.jsxs)(n.li,{children:["Button enables, ",(0,s.jsx)(n.code,{children:"disabled-oos"})," class removed"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Add to Cart"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Form submits with CAPA variant ID"}),"\n",(0,s.jsx)(n.li,{children:"Purchase completes successfully"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"what-this-fix-does-not-change",children:"What This Fix Does NOT Change"}),"\n",(0,s.jsxs)(n.p,{children:["This fix is narrowly scoped to the quality selection availability logic. It does ",(0,s.jsx)(n.strong,{children:"not"})," modify:"]}),"\n",(0,s.jsx)(n.h3,{id:"unchanged-gating-mechanisms",children:"Unchanged Gating Mechanisms"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Fitment Validation:"})," Fitment questions and compatibility checks remain unchanged"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"VIN Verification:"})," OEM products still require VIN input if configured"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Paint Disclaimer:"})," Precision match or paint disclaimers still gate the button"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Assembly Options:"})," Assembly selection requirements are unaffected"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Inventory Source:"})," No changes to how Shopify or external systems report availability"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"unchanged-button-states",children:"Unchanged Button States"}),"\n",(0,s.jsx)(n.p,{children:"The button can still be disabled by:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Missing fitment verification (if required)"}),"\n",(0,s.jsx)(n.li,{children:"Missing VIN for OEM products"}),"\n",(0,s.jsx)(n.li,{children:"Unchecked paint disclaimers"}),"\n",(0,s.jsx)(n.li,{children:"Invalid form state (e.g., no paint option selected)"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Important:"})," This fix only controls the ",(0,s.jsx)(n.code,{children:"disabled-oos"})," state based on selected quality availability. All other disabling mechanisms remain independent and functional."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"technical-notes",children:"Technical Notes"}),"\n",(0,s.jsxs)(n.h3,{id:"why-data-available-attribute",children:["Why ",(0,s.jsx)(n.code,{children:"data-available"})," Attribute?"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"data-available"})," attribute is the most reliable source for quality variant availability because:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Set server-side by Liquid template based on Shopify product data"}),"\n",(0,s.jsx)(n.li,{children:"Reflects real inventory status at page render time"}),"\n",(0,s.jsx)(n.li,{children:"Already used throughout the quality selection UI"}),"\n",(0,s.jsx)(n.li,{children:"Avoids additional API calls or state synchronization"}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"why-not-use-windowproductvariants",children:["Why Not Use ",(0,s.jsx)(n.code,{children:"window.productVariants"}),"?"]}),"\n",(0,s.jsxs)(n.p,{children:["While ",(0,s.jsx)(n.code,{children:"window.productVariants"})," contains availability data, it is:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Structured differently for different product types (painted vs unpainted)"}),"\n",(0,s.jsx)(n.li,{children:"Sometimes nested under quality groups (aftermarket, capa, oem)"}),"\n",(0,s.jsx)(n.li,{children:"Not guaranteed to be populated before quality selection"}),"\n",(0,s.jsx)(n.li,{children:"More complex to query reliably"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"data-available"})," attribute provides a simpler, more direct source of truth."]}),"\n",(0,s.jsx)(n.h3,{id:"button-references",children:"Button References"}),"\n",(0,s.jsx)(n.p,{children:"The function updates both button references:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"currentAddToCartBtnLibrary"}),": Main Add to Cart button on desktop"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"addToCartStickyLibrary"}),": Sticky Add to Cart button (appears on scroll)"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Both must be updated to ensure consistent behavior across viewports."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"testing-recommendations",children:"Testing Recommendations"}),"\n",(0,s.jsx)(n.h3,{id:"manual-testing-checklist",children:"Manual Testing Checklist"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Test Case 1: OOS Base to In-Stock Quality"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Navigate to a product with OOS Aftermarket but in-stock CAPA"}),"\n",(0,s.jsx)(n.li,{children:"Verify button is disabled on load"}),"\n",(0,s.jsx)(n.li,{children:"Select CAPA quality"}),"\n",(0,s.jsx)(n.li,{children:'Select "Unpainted" paint option'}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Button should enable and allow Add to Cart"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Test Case 2: In-Stock Base to OOS Quality"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Navigate to a product with in-stock Aftermarket but OOS CAPA"}),"\n",(0,s.jsx)(n.li,{children:"Select CAPA quality"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Button should disable (cannot purchase OOS variant)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Test Case 3: Direct In-Stock Variant Landing"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Navigate directly to an in-stock CAPA variant URL"}),"\n",(0,s.jsx)(n.li,{children:"Select paint option"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Button should enable (no regression)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Test Case 4: Multiple Quality Switches"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Select CAPA (in stock) \u2192 button enables"}),"\n",(0,s.jsx)(n.li,{children:"Select OEM (OOS) \u2192 button disables"}),"\n",(0,s.jsx)(n.li,{children:"Select CAPA (in stock) again \u2192 button re-enables"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Button state should track quality availability"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Test Case 5: Fitment Interaction"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Select in-stock quality, select paint option"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 If fitment is invalid, button should remain disabled"}),"\n",(0,s.jsx)(n.li,{children:"Correct fitment"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Button should enable (OOS fix + fitment logic work together)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"edge-cases",children:"Edge Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Products with only one quality option (no radio buttons)"}),"\n",(0,s.jsx)(n.li,{children:"Products with no quality options (single variant products)"}),"\n",(0,s.jsx)(n.li,{children:"Products where all quality options are OOS"}),"\n",(0,s.jsx)(n.li,{children:"Mobile vs desktop viewports (sticky button behavior)"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"deployment-notes",children:"Deployment Notes"}),"\n",(0,s.jsx)(n.h3,{id:"files-changed",children:"Files Changed"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"assets/product-page-component-library.js"})," (1 function modified)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"no-database-changes-required",children:"No Database Changes Required"}),"\n",(0,s.jsx)(n.p,{children:"This fix is entirely client-side logic. No Shopify metafields, product templates, or backend changes are needed."}),"\n",(0,s.jsx)(n.h3,{id:"rollback-procedure",children:"Rollback Procedure"}),"\n",(0,s.jsxs)(n.p,{children:["If issues arise, revert the ",(0,s.jsx)(n.code,{children:"enableAddToCartButton()"})," function to its previous implementation:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"function enableAddToCartButton() {\n\tif (window.blockAddToCart) {\n\t\tdisableAddToCartButton();\n\t\treturn;\n\t}\n\tif (currentAddToCartBtnLibrary) currentAddToCartBtnLibrary.disabled = false;\n\tif (addToCartStickyLibrary) addToCartStickyLibrary.disabled = false;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"No other cleanup required."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["VIN Decoder Implementation: ",(0,s.jsx)(n.code,{children:"/docs/product-page/vin-decoder"})]}),"\n",(0,s.jsx)(n.li,{children:"Quality Options UI: (TBD)"}),"\n",(0,s.jsx)(n.li,{children:"Product Page Customization: (TBD)"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Last Updated:"})," January 3, 2025",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Status:"})," Active",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Applies to:"})," Partify Theme v3.x+"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453(e,n,i){i.d(n,{R:()=>a,x:()=>d});var t=i(6540);const s={},l=t.createContext(s);function a(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);